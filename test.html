<html>
<head>
	<title>Pixi</title>

</head>
<body>
	<script src="//cdnjs.cloudflare.com/ajax/libs/pixi.js/3.0.8/pixi.min.js"></script>
	<script type="text/javascript">

		var Container = PIXI.Container,
			autoDetectRenderer = PIXI.autoDetectRenderer,
			loader = PIXI.loader,
			resources = PIXI.loader.resources,
			textures = PIXI.utils.TextureCache,
			Sprite = PIXI.Sprite;

		var maxWidth = window.innerWidth;
		var maxHeight = window.innerHeight;

		var stage = new Container(),
			renderer = autoDetectRenderer(maxWidth, maxHeight);
		document.body.appendChild(renderer.view);

		loader.add("assets/buildings.json")
			   .add("assets/base.json")
			   .load(setup);
		

		var Info = function (){};
	
		
		function createSprite (spriteId){
				var sprite = textures[spriteId];

				return new Sprite(sprite);
		}

		function createRowTiles(container,info){

			for(var row =0; row < info.numberOfRow; row += info.rowIncrease){

				for( var col =0; col < info.numberOfCol; col += info.colIncrease){

					var tile = createSprite(info.tileId);

					var x = info.startX + info.width * col + info.distanceX * col;
					var y = info.startY + info.height * row + info.distanceY * row ;

					tile.position.set(x,y);
					container.addChild(tile);
				}
			}
		}

		function createColTiles(container,info){

			for(var col =0; col < info.numberOfCol; col += info.colIncrease ){

				for( var row =0; row < info.numberOfRow; row += info.rowIncrease){

					var tile = createSprite(info.tileId);

					var x = info.startX + info.width * col + info.distanceX * col;
					var y = info.startY + info.height * row + info.distanceY * row ;

					tile.position.set(x,y);
					container.addChild(tile);
				}
			}
		}

		var Tile = function(){

			//ground
			this.grass = "tileGrass.png";
			this.snow = "tileSnow.png";
			this.magic = "tileMagic.png";
			this.water = "tileWater.png";

			//bridge
			this.bridgeStone = "tileStone_bridge.png";
			this.bridgeWood = "tileWood_bridge.png";


			//building
			this.sandGateRight = "sandGateRight.png";
			this.sandWindowBlinds = "sandWindowBlinds.png";
			this.sandWindows = "sandWindows.png";
			this.sandRoofPointy =  "sandRoofPointy.png";

		}
		function createMap(container){

			
			var tile = new Tile();
			
			//fill ground with  "tileWater.png"  width="65" height="89"

			var info = new Info();
			info.startX = 5;
			info.startY = 20;
			info.width = 65;
			info.height = 50;
			info.distanceX = 0;
			info.distanceY = 0;
			info.tileId = tile.water;
			info.numberOfRow = 10;
			info.numberOfCol = 19;
			info.rowIncrease = 1;
			info.colIncrease = 1;

			createRowTiles(container, info);
			

			//create ground with  "tileGrass.png"  width="65" height="89"
			info.startX = 5;
			info.startY = 20;
			info.width = 65;
			info.height = 50;
			info.tileId = tile.grass;
			info.numberOfRow = 6;
			info.numberOfCol = 7;

			createRowTiles(container, info);

			

			//create ground with  "tileSnow.png"  width="65" height="89"
			info.startX =  5 + 12 * 65 ;
			info.startY = 20;
			info.width = 65;
			info.height = 50;
			info.tileId = tile.snow;
			info.numberOfRow = 6;
			info.numberOfCol = 7;

			createRowTiles(container, info);

			
		//below half map

			//fill ground with  "tileMagic.png"  width="65" height="89"
			info.startX =  5 ;
			info.startY = 20 + 89*6 -40;
			info.width = 65;
			info.height = 50;
			info.tileId = tile.magic;
			info.numberOfRow = 5;
			info.numberOfCol = 19;

			createRowTiles(container, info);

			
			info.tileId = tile.bridgeStone;
			CreateBridgeFromWoodToSnow(container,info);

			info.tileId = tile.bridgeWood;
			CreateBridgeFromWoodToMagic(container,info);

			CreateBridgeFromSnowToMagic(container,info);
			
			

			
		}


		function CreateBridgeFromWoodToSnow(container, info){
			//create bridge with 'tileWood_bridge.png' width="65" height="89"
			//bridge connect grassland with magicland

			info.startX =  5 +7 * 65 ;
			info.startY = 20 + 89 ;
			info.width = 65;
			info.height = 50;

			info.numberOfRow = 4;
			info.numberOfCol = 5;
			info.rowIncrease = 2;
			info.colIncrease = 1;
			

			createRowTiles(container,info);
		}

		function CreateBridgeFromSnowToMagic(container, info){

			//create bridge with 'tileWood_bridge.png' width="65" height="89"
			//bridge connect snowland with magicland
			info.startX =  5 +14 * 65 ;
			info.startY = 20 + 89 *3 + 40;
			info.width = 65;
			info.height = 50;

			info.numberOfCol = 4;
			info.numberOfRow = 4
			info.colIncrease = 2;
			info.rowIncrease = 1;

			createColTiles(container,info);

		}

		function CreateBridgeFromWoodToMagic(container, info){
			//create bridge with 'tileWood_bridge.png' width="65" height="89"
			//bridge connect grassland with magicland
			info.startX =  5 +2 * 65 ;
			info.startY = 20 + 89 *3 + 40;
			info.width = 65;
			info.height = 50;

			info.numberOfCol = 4;
			info.numberOfRow = 4
			info.colIncrease = 2;
			info.rowIncrease = 1;

			createColTiles(container,info);


		}

		function DecorationForMap(container){
			//treeAutumn_high.png,treeAutumn_low.png.,treeAutumn_mid.png,treeBlue_high.png
			//treeCactus_1.png, treeCactus_2.png, treeCactus_3.png
			//treeGreen_high.png
			//pineAutumn_high.png
			//waveLava.png
			//waveWater.png

			//bushAutumn.png, bushDirt.png, bushGrass.png, bushMagic.png, bushSand.png , bushSnow.png
			//flowerBlue.png, flowerGreen.png, flowerRed.png,flowerWhite.png, flowerYellow.png

			var startX =  5 ;
			var startY = 20;
			var width = 27;
			var height = 107;
			var space = 10;

			//row of tree
			for(var row =0; row < 1; ++ row){

				for( var col =0; col < 10; ++col){
					var tileGrass = createSprite("treeBlue_low.png");

					var x = startX + width * col + space * col;
					var y = startY + row * height;
					tileGrass.position.set(x,y);
					container.addChild(tileGrass);
				}
			}

			//column of tree
			height = 80;
			for(var col =0; col < 1; ++ col){

				for( var row =0; row < 3; ++row){
					var tileGrass = createSprite("treeAutumn_low.png");

					var x = startX + width * col + space * col;
					var y = startY + row * height;
					tileGrass.position.set(x,y);
					container.addChild(tileGrass);
				}
			}

			//flowerRed
			startX = 50;
			startY = 100;
			width = 12;
			height = 11;
			for(var row =0; row < 3; ++ row){

				for( var col =0; col < 4; ++col){
					var tileGrass = createSprite("flowerRed.png");

					var x = startX + width * col + space * col;
					var y = startY + row * height;
					tileGrass.position.set(x,y);
					container.addChild(tileGrass);
				}
			}

			//flowerBlue
			startX = 200;
			startY = 100;
			width = 12;
			height = 11;
			for(var row =0; row < 3; ++ row){

				for( var col =0; col < 4; ++col){
					var tileGrass = createSprite("flowerBlue.png");

					var x = startX + width * col + space * col;
					var y = startY + row * height;
					tileGrass.position.set(x,y);
					container.addChild(tileGrass);
				}
			}

			//flowerGreen
			startX = 200;
			startY = 600;
			width = 12;
			height = 11;
			for(var row =0; row < 3; ++ row){

				for( var col =0; col < 4; ++col){
					var tileGrass = createSprite("flowerGreen.png");

					var x = startX + width * col + space * col;
					var y = startY + row * height;
					tileGrass.position.set(x,y);
					container.addChild(tileGrass);
				}
			}




		}
		
		function setup(){

			var building = new Container();

			/*var sandDoorId = [ "sandDoorLeft.png", "sandDoorRight.png",  "sandDoorWindow.png", "sandDoorWindowBlinds.png",
				 				"sandDoorWindowBlindsMirror.png","sandDoorWindowMirror.png"];

			var sandGateId = [ "sandGateLeft.png", "sandGateRight.png", "sandRing.png"];

			var sandRoofId = [ "sandRoofPointy.png","sandRoofRounded.png","sandRoofShort.png",
								"sandRoofStraight.png","sandRoofTall.png"]

			var sandWindowId =  ["sandWindowBlinds.png", "sandWindowBlindsLeft.png", "sandWindowBlindsRight.png", 
								"sandWindowLeft.png", "sandWindowRight.png","sandWindows.png"];*/
		
			createMap(building);

			DecorationForMap(building);

			var tile = new Tile();
			var info = new Info();

			info.startX = 600;
			info.startY = 500;
			info.modify = 22;
			info.numberOfFloor = 4;
			info.gate = tile.sandGateRight;
			info.floor =[tile.sandWindowBlinds, tile.sandWindows];
			info.roof = tile.sandRoofPointy; 

			createSandBuilding(building, info);

			renderer.render(building);
		
		}

		function createSandBuilding(container){
			
		}

		function createSandBuilding(container, info){

			var x = info.startX;
			var y = info.startY;
			var modify = info.modify;
			

			//build base
		
			var gate = createSprite( info.gate) ;
			gate.position.set(x , y);
			container.addChild(gate);

			//build 4 floor
			var i =0;
			while( i < info.numberOfFloor){

				for( var floorType =0; floorType < info.floor.length; ++floorType){
					++i;
					var floor = createSprite( info.floor[floorType] );
					floor.position.set( x, y - modify*i);
					container.addChild( floor );
				}
			

			}

			//build roof
			++i;
			var roof = createSprite( info.roof );
			roof.position.set(x,y - modify*i);
			container.addChild(roof);
		}

		

	</script>
</body>
</html>