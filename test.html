<html>
<head>
	<title>Pixi</title>

</head>
<body>
	<script src="//cdnjs.cloudflare.com/ajax/libs/pixi.js/3.0.8/pixi.min.js"></script>
	<script type="text/javascript">

		var Container = PIXI.Container,
			autoDetectRenderer = PIXI.autoDetectRenderer,
			loader = PIXI.loader,
			resources = PIXI.loader.resources,
			textures = PIXI.utils.TextureCache,
			Sprite = PIXI.Sprite;

		var maxWidth = window.innerWidth;
		var maxHeight = window.innerHeight;

		var stage = new Container(),
			renderer = autoDetectRenderer(maxWidth, maxHeight);
		document.body.appendChild(renderer.view);

		loader.add("assets/buildings.json")
			   .add("assets/base.json")
			   .load(setup);
		

		var Info = function (){};
		
		function setup(){

			var container = new Container();
		
			createMap(container);

			DecorationForMap(container);

			createSandBuildingType1(container);
			createWoodBuildingType1(container);
			createStoneBuildingType1(container);
		
			renderer.render(container);
		
		}

		
		function createSprite (spriteId){
				var sprite = textures[spriteId];

				return new Sprite(sprite);
		}

		function createRowTiles(container,info){

			for(var row =0; row < info.numberOfRow; row += info.rowIncrease){

				for( var col =0; col < info.numberOfCol; col += info.colIncrease){

					var tile = createSprite(info.tileId);

					var x = info.startX + info.width * col + info.distanceX * col;
					var y = info.startY + info.height * row + info.distanceY * row ;

					tile.position.set(x,y);
					container.addChild(tile);
				}
			}
		}

		function createColTiles(container,info){

			for(var col =0; col < info.numberOfCol; col += info.colIncrease ){

				for( var row =0; row < info.numberOfRow; row += info.rowIncrease){

					var tile = createSprite(info.tileId);

					var x = info.startX + info.width * col + info.distanceX * col;
					var y = info.startY + info.height * row + info.distanceY * row ;

					tile.position.set(x,y);
					container.addChild(tile);
				}
			}
		}

		var Tile = function(){

			//ground
			this.grass = "tileGrass.png";
			this.snow = "tileSnow.png";
			this.magic = "tileMagic.png";
			this.water = "tileWater.png";

			//bridge
			this.bridgeStone = "tileStone_bridge.png";
			this.bridgeWood = "tileWood_bridge.png";


			//building
			this.sandGateRight = "sandGateRight.png";
			this.sandWindowBlinds = "sandWindowBlinds.png";
			this.sandWindows = "sandWindows.png";
			this.sandRoofPointy =  "sandRoofPointy.png";
			this.sandRoofRounded = "sandRoofRounded.png";
			this.sandGateLeft = "sandGateLeft.png";
			this.sandRing = "sandRing.png";


			this.stoneDoorLeft = "stoneDoorLeft.png";
			this.stoneDoorRight = "stoneDoorRight.png";
			this.stoneGateLeft = "stoneGateLeft.png";
			this.stoneGateRight = "stoneGateRight.png";
			this.stoneRoofPointy = "stoneRoofPointy.png";
			this.stoneRoofRounded = "stoneRoofRounded.png";
			this.stoneRoofShort = "stoneRoofShort.png";
			this.stoneWindowBlinds = "stoneWindowBlinds.png";
			this.stoneWindowBlindsLeft = "stoneWindowBlindsLeft.png";
			this.stoneWindowLeft = "stoneWindowLeft.png";
			this.stoneRing = "stoneRing.png";

			this.woodDoorLeft = "woodDoorLeft.png";
			this.woodDoorRight = "woodDoorRight.png";
			this.woodDoorWindow = "woodDoorWindow.png";
			this.woodGateLeft = "woodGateLeft.png";
			this.woodGateRight = "woodGateRight.png";
			this.woodDoorWindowBlindsMirror = "woodDoorWindowBlindsMirror.png";
			this.woodWindowBlinds = "woodWindowBlinds.png";
			this.woodWindowBlindsLeft = "woodWindowBlindsLeft.png";
			this.woodWindowBlindsRight = "woodWindowBlindsRight.png";
			this.woodRoofPointy = "woodRoofPointy.png";
			this.woodRoofRounded = "woodRoofRounded.png";
			this.woodRing = "woodRing.png";

		}
		function createMap(container){

			
			var tile = new Tile();
			
			//fill ground with  "tileWater.png"  width="65" height="89"

			var info = new Info();
			info.startX = 5;
			info.startY = 20;
			info.width = 65;
			info.height = 50;
			info.distanceX = 0;
			info.distanceY = 0;
			info.tileId = tile.water;
			info.numberOfRow = 10;
			info.numberOfCol = 19;
			info.rowIncrease = 1;
			info.colIncrease = 1;

			createRowTiles(container, info);
			

			//create ground with  "tileGrass.png"  width="65" height="89"
			info.startX = 5;
			info.startY = 20;
			info.width = 65;
			info.height = 50;
			info.tileId = tile.grass;
			info.numberOfRow = 6;
			info.numberOfCol = 7;

			createRowTiles(container, info);

			

			//create ground with  "tileSnow.png"  width="65" height="89"
			info.startX =  5 + 12 * 65 ;
			info.startY = 20;
			info.width = 65;
			info.height = 50;
			info.tileId = tile.snow;
			info.numberOfRow = 6;
			info.numberOfCol = 7;

			createRowTiles(container, info);

			
		//below half map

			//fill ground with  "tileMagic.png"  width="65" height="89"
			info.startX =  5 ;
			info.startY = 20 + 89*6 -40;
			info.width = 65;
			info.height = 50;
			info.tileId = tile.magic;
			info.numberOfRow = 5;
			info.numberOfCol = 19;

			createRowTiles(container, info);

			
			info.tileId = tile.bridgeStone;
			CreateBridgeFromWoodToSnow(container,info);

			info.tileId = tile.bridgeWood;
			CreateBridgeFromWoodToMagic(container,info);

			CreateBridgeFromSnowToMagic(container,info);
			
			

			
		}


		function CreateBridgeFromWoodToSnow(container, info){
			//create bridge with 'tileWood_bridge.png' width="65" height="89"
			//bridge connect grassland with magicland

			info.startX =  5 +7 * 65 ;
			info.startY = 20 + 89 ;
			info.width = 65;
			info.height = 50;

			info.numberOfRow = 4;
			info.numberOfCol = 5;
			info.rowIncrease = 2;
			info.colIncrease = 1;
			

			createRowTiles(container,info);
		}

		function CreateBridgeFromSnowToMagic(container, info){

			//create bridge with 'tileWood_bridge.png' width="65" height="89"
			//bridge connect snowland with magicland
			info.startX =  5 +14 * 65 ;
			info.startY = 20 + 89 *3 + 40;
			info.width = 65;
			info.height = 50;

			info.numberOfCol = 4;
			info.numberOfRow = 4
			info.colIncrease = 2;
			info.rowIncrease = 1;

			createColTiles(container,info);

		}

		function CreateBridgeFromWoodToMagic(container, info){
			//create bridge with 'tileWood_bridge.png' width="65" height="89"
			//bridge connect grassland with magicland
			info.startX =  5 +2 * 65 ;
			info.startY = 20 + 89 *3 + 40;
			info.width = 65;
			info.height = 50;

			info.numberOfCol = 4;
			info.numberOfRow = 4
			info.colIncrease = 2;
			info.rowIncrease = 1;

			createColTiles(container,info);


		}

		function DecorationForMap(container){
			//treeAutumn_high.png,treeAutumn_low.png.,treeAutumn_mid.png,treeBlue_high.png
			//treeCactus_1.png, treeCactus_2.png, treeCactus_3.png
			//treeGreen_high.png
			//pineAutumn_high.png
			//waveLava.png
			//waveWater.png

			//bushAutumn.png, bushDirt.png, bushGrass.png, bushMagic.png, bushSand.png , bushSnow.png
			//flowerBlue.png, flowerGreen.png, flowerRed.png,flowerWhite.png, flowerYellow.png

			var tile = new Tile();
			tile.treeCactus_1 = "treeCactus_1.png";
			tile.treeBlue_low = "treeBlue_low.png";
			
			var startX =  5 ;
			var startY = 20;
			var width = 27;
			var height = 107;
			var space = 10;

			//row of tree
			for(var row =0; row < 1; ++ row){

				for( var col =0; col < 10; ++col){
					var tileGrass = createSprite("treeBlue_low.png");

					var x = startX + width * col + space * col;
					var y = startY + row * height;
					tileGrass.position.set(x,y);
					container.addChild(tileGrass);
				}
			}

			//column of tree
			height = 80;
			for(var col =0; col < 1; ++ col){

				for( var row =0; row < 3; ++row){
					var tileGrass = createSprite("treeAutumn_low.png");

					var x = startX + width * col + space * col;
					var y = startY + row * height;
					tileGrass.position.set(x,y);
					container.addChild(tileGrass);
				}
			}

			//flowerRed
			startX = 50;
			startY = 100;
			width = 12;
			height = 11;
			for(var row =0; row < 3; ++ row){

				for( var col =0; col < 4; ++col){
					var tileGrass = createSprite("flowerRed.png");

					var x = startX + width * col + space * col;
					var y = startY + row * height;
					tileGrass.position.set(x,y);
					container.addChild(tileGrass);
				}
			}

			//flowerBlue
			startX = 200;
			startY = 100;
			width = 12;
			height = 11;
			for(var row =0; row < 3; ++ row){

				for( var col =0; col < 4; ++col){
					var tileGrass = createSprite("flowerBlue.png");

					var x = startX + width * col + space * col;
					var y = startY + row * height;
					tileGrass.position.set(x,y);
					container.addChild(tileGrass);
				}
			}

			//flowerGreen
			startX = 200;
			startY = 600;
			width = 12;
			height = 11;
			for(var row =0; row < 3; ++ row){

				for( var col =0; col < 4; ++col){
					var tileGrass = createSprite("flowerGreen.png");

					var x = startX + width * col + space * col;
					var y = startY + row * height;
					tileGrass.position.set(x,y);
					container.addChild(tileGrass);
				}
			}




		}
		
		function createSandBuildingType1(container){
			var tile = new Tile();
			var info = new Info();

		
		//Groupd of Sand Building 
			info.startX = 	600;
			info.startY = 600;
			info.modify = 22;
			info.numberOfFloor = 3;
			info.gate = tile.sandRing;
			info.floor =[tile.sandWindowBlinds, tile.sandWindows];
			info.roof = tile.sandRoofRounded; 

			createBuilding(container, info);

			info.startX = 	600 +35;
			info.startY = 600 +2;
			info.modify = 22;
			info.numberOfFloor = 5;
			info.gate = tile.sandGateRight;
			info.floor =[tile.sandWindowBlinds, tile.sandWindows];
			info.roof = tile.sandRoofPointy; 

			createBuilding(container, info);

			info.startX = 	600 -65 ;
			info.startY = 600 ;
			info.modify = 22;
			info.numberOfFloor = 3;
			info.gate = tile.sandRing;
			info.floor =[tile.sandWindowBlinds, tile.sandWindows];
			info.roof = tile.sandRoofRounded; 

			createBuilding(container, info);
			
			info.startX = 	600 - 65 -35;
			info.startY = 600 +2;
			info.modify = 22;
			info.numberOfFloor = 5;
			info.gate = tile.sandGateLeft;
			info.floor =[tile.sandWindowBlinds, tile.sandWindows];
			info.roof = tile.sandRoofPointy; 

			createBuilding(container, info);
		}

		function createStoneBuildingType1(container){
			var tile = new Tile();
			var info = new Info();

			//Group of Stone Building
			
			info.startX = 150;
			info.startY = 150;
			info.modify = 22;
			info.numberOfFloor = 2;
			info.gate = tile.stoneDoorLeft;
			info.floor =[tile.stoneWindowBlinds, tile.stoneWindowBlindsLeft];
			info.roof = tile.stoneRoofShort; 

			createBuilding(container, info);

			info.startX = 150 + 65;
			info.startY = 150;
			info.modify = 22;
			info.numberOfFloor = 3;
			info.gate = tile.stoneDoorLeft;
			info.floor =[tile.stoneWindowBlinds, tile.stoneWindowBlindsLeft];
			info.roof = tile.stoneRoofRounded; 

			createBuilding(container, info);

			info.startX = 150 + 65*2;
			info.startY = 150;
			info.modify = 22;
			info.numberOfFloor = 5;
			info.gate = tile.stoneGateLeft;
			info.floor =[tile.stoneWindowBlinds, tile.stoneWindowBlindsLeft];
			info.roof = tile.stoneRoofPointy; 

			createBuilding(container, info);
		}

		function createWoodBuildingType1(container){

			var tile = new Tile();
			var info = new Info();

			info.startX = 150 + 65*14;
			info.startY = 150;
			info.modify = 22;
			info.numberOfFloor = 5;
			info.gate = tile.woodGateRight;
			info.floor =[tile.woodWindowBlinds];
			info.roof = tile.woodRoofRounded;

			createBuilding(container, info);
			

		}
		

		function createBuilding(container, info){

			var x = info.startX;
			var y = info.startY;
			var modify = info.modify;
			

			//build base
		
			var gate = createSprite( info.gate) ;
			gate.position.set(x , y);
			container.addChild(gate);


			//build 4 floor
			var i =0;
			if( info.floor.length != 0){
				while( i <= info.numberOfFloor){

					for( var floorType =0; floorType < info.floor.length; ++floorType){
						++i;
						if( i > info.numberOfFloor) break;
						var floor = createSprite( info.floor[floorType] );
						floor.position.set( x, y - modify*i);
						container.addChild( floor );
					}
				

				}
			}else{
				++i;
			}

			//build roof
			
			var roof = createSprite( info.roof );
			roof.position.set(x,y - modify*i);
			container.addChild(roof);
		}

		

	</script>
</body>
</html>